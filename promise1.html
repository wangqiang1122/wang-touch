<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>

</body>
<script>
    function P(fn) {
       this.resolve = [];
       this.reject = [];
       let self = this;
        var cacth = null;
      fn(function (success) {
          // self.resolve.forEach((item)=>{
          //     if(item(success)){
          //        return item(success)
          //     }
          // })
          for (var a=0; a<self.resolve.length;a++){
              // console.log(self.resolve[a](success) instanceof P);
              var g = self.resolve[a](success);
              console.log(g)
              if(g instanceof P){
                 next(g);
                 break;
              }
          }
          function next(val) {
              console.log(val)
              val.then(function (data) {
                  console.log(data);
                  console.log(1111)
              });
          }

      },function (fail) {

      })
    }

    P.prototype.then=function (fn1,fn2) {
        this.resolve.push(fn1);
        this.reject.push(fn2)
        return this;
    };

  var pro = new P(function (resolve,reject) {
      setTimeout(()=>{
          resolve('nnnn')
      },500)
  });
    pro.then(function (data) {
        return new P(function (resolve) {
            resolve('aaaa')
        })
    }).then(function (adta) {
        console.log(adta)
    })


    // var pro1 = new Promise(function (resolve,reject) {
    //     resolve(1);
    // })
    // pro1.then(function () {
    //
    // }).then(function () {
    //     console.log('äºŒ')
    // })
</script>
</html>